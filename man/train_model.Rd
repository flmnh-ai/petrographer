% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/training.R
\name{train_model}
\alias{train_model}
\title{Train a new petrography detection model}
\usage{
train_model(
  data_dir,
  output_name = "petrography_model",
  max_iter = 5000,
  learning_rate = 0.001,
  num_classes = 5,
  device = "cpu",
  eval_period = 500,
  checkpoint_period = 0,
  hpc_host = NULL,
  hpc_user = NULL,
  hpc_base_dir = NULL,
  local_output_dir = "Detectron2_Models",
  cleanup_remote = FALSE,
  poll_interval = 30,
  max_duration = 8 * 3600,
  max_idle = 1800,
  hpc_profile = "hpg",
  rsync_mode = c("update", "mirror"),
  dry_run = FALSE
)
}
\arguments{
\item{data_dir}{Local directory containing train and val subdirectories with COCO annotations}

\item{output_name}{Name for the trained model (default: "petrography_model")}

\item{max_iter}{Maximum training iterations (default: 5000)}

\item{learning_rate}{Learning rate for training (default: 0.001)}

\item{num_classes}{Number of object classes (default: 5)}

\item{device}{Device for local training: 'cpu', 'cuda', 'mps' (default: 'cpu')}

\item{eval_period}{Validation evaluation frequency in iterations (default: 500)}

\item{checkpoint_period}{Checkpoint saving frequency (0=final only, >0=every N iterations, default: 0)}

\item{hpc_host}{SSH hostname for HPC training (NULL for local training)}

\item{hpc_user}{Username for HPC (default: current user)}

\item{hpc_base_dir}{Remote base directory on HPC (default: "~/petrography_training")}

\item{local_output_dir}{Local directory to save trained model (default: "Detectron2_Models")}

\item{cleanup_remote}{Deprecated; remote cleanup is not performed (kept for compatibility)}

\item{poll_interval}{How often to check job status in seconds (default: 30)}

\item{max_duration}{Max seconds to monitor before timing out (default: 8 hours)}

\item{max_idle}{Max seconds without output before aborting (default: 30 minutes)}

\item{hpc_profile}{Named HPC profile for modules/resources (default: 'hpg')}

\item{rsync_mode}{Data sync mode: 'update' (default) or 'mirror' (adds --delete)}

\item{dry_run}{If TRUE, rsync runs with -n to preview changes}
}
\value{
Path to trained model directory
}
\description{
Train a new petrography detection model
}
